# club-calendar

部活動の集会に関するデータを管理する API と、それを表示するウェブサイトを提供するプロジェクト。


# ウェブサイト

スケジュールの入ったカレンダーが表示される。

集会の追加ボタンを押すと画面が開き、集会の設定と追加ができる。

スケジュール上の集会をクリックすると画面が開き、集会の設定と中止ができる。


# API

サーバーの `/api/` ディレクトリ下の以下のものにアクセスして集会データを扱える。

## 使い方

### 取得

`GET /api/fetch` に以下のクエリを付けてアクセスする。

正常なクエリ引数を渡さないと `400 Bad Request` を返す。

| 引数 | 意味                                                   |
| ---- | ------------------------------------------------------ |
| kind | 取得する集会の種別で、`Regular` か `Others` にできる。 |
| from | 日時の文字列で、これ以降の集会を取得する。             |
| to   | 日時の文字列で、これ以前の集会を取得する。             |

レスポンスは以下のような JSON である。

```json
{
  "meetings": [
    {
      "_id": "hoge",
      "kind": "Others",
      "name": "ホゲ談義",
      "date": "2019-12-12T12:12:00",
      "expired": false
    }
  ]
}
```

### 作成

`POST /api/create` に以下の JSON を付けてアクセスする。

正常な本文を渡さないと `400 Bad Request` を返す。

```json
{
  "kind": "Others",
  "name": "ホゲ談義",
  "date": "2019-12-12T12:12:00"
}
```

作成に成功すると以下のような JSON を返す。

```json
{
  "ids": [
    "hoge"
  ]
}
```

### 更新

`POST /api/update` に以下の JSON を付けてアクセスする。

正常な本文を渡さないと `400 Bad Request` を返す。

`_id` は必須だが、それ以外は更新したい属性だけを渡す。

```json
{
  "_id": "hoge",
  "kind": "Others",
  "name": "ホゲ談義",
  "date": "2019-12-12T12:12:00"
}
```

更新に成功すると `200 Meeting Updated` を返す。

### 中止

`POST /api/abort` に以下の JSON を付けてアクセスする。

正常な本文を渡さないと `400 Bad Request` を返す。

`_id` だけを渡す。

```json
{
  "_id": "hoge"
}
```

更新に成功するとその集会の `expired` 属性が `true` になり、`200 Meeting Aborted` を返す。

## 使用例

| API        | リクエスト例                                                | 本文例                                                                        | レスポンス例                                                                                           |
| ---------- | ----------------------------------------------------------- | ----------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| 集会の取得 | `GET /api/fetch?kind=Regular&from=2020-01-01&to=2020-12-31` | N/A                                                                           | `{"meetings": [{"_id": "hoge", "kind": "Others", "name": "ホゲ談義", "date": "2012-12-12T12:12:00"}]}` |
| 集会の作成 | `POST /api/create`                                          | `{"kind": "Others", "name": "helloworld2019", "date": "2019-12-16T16:15:00"}` | `{"_id": "hoge"}`                                                                                      |
| 集会の更新 | `POST /api/update`                                          | `{"_id": "hoge", "name": "ホゲ談義", "date": "2019-12-12T12:12:00"}`          | `Meeting Updated`                                                                                      |
| 集会の中止 | `POST /api/abort`                                           | `{"_id": "hoge"}`                                                             | `Meeting Aborted`                                                                                      |
